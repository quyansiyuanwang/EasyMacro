# EasyMacro

![main language](https://img.shields.io/badge/python-3.13-blue?logo=python)
![platform](https://img.shields.io/badge/platform-windows-blueviolet.svg)
![license](https://img.shields.io/github/license/quyansiyuanwang/EasyMacro.svg)
![GitHub Actions Workflow Status](https://img.shields.io/github/actions/workflow/status/quyansiyuanwang/EasyMacro/checks.yml)
![repo size](https://img.shields.io/github/repo-size/quyansiyuanwang/EasyMacro)
![last commit](https://img.shields.io/github/last-commit/quyansiyuanwang/EasyMacro)
![doc last](https://img.shields.io/badge/docs%20last-2025--08--05-blue.svg)

ä¸€ä¸ªåŸºäºçƒ­é”®è§¦å‘çš„å®ç®¡ç†ç³»ç»Ÿï¼Œé€šè¿‡ JSON é…ç½®æ–‡ä»¶å®šä¹‰è‡ªåŠ¨åŒ–å®æ“ä½œï¼Œæ”¯æŒé”®ç›˜ã€é¼ æ ‡ã€æ–‡æœ¬è¾“å…¥ç­‰å¤šç§æ“ä½œç±»å‹ã€‚

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ¯ **çƒ­é”®è§¦å‘**: æ”¯æŒå¤šç§çƒ­é”®ç»„åˆï¼ŒåŒ…æ‹¬å•é”®ã€ç»„åˆé”®ç­‰
- ğŸ“ **JSON é…ç½®**: é€šè¿‡ JSON æ–‡ä»¶çµæ´»å®šä¹‰å®è¡Œä¸ºï¼Œæ˜“äºç¼–è¾‘å’Œç»´æŠ¤
- ğŸ”§ **å¤šä»»åŠ¡ç±»å‹**: æ”¯æŒé”®ç›˜è¾“å…¥ã€é¼ æ ‡æ“ä½œã€æ–‡æœ¬è¾“å…¥ã€ç³»ç»Ÿå‘½ä»¤ç­‰
- ğŸ¨ **å·¥ä½œæµå¼•æ“**: é›†æˆ RecognizerFrameworkï¼Œæ”¯æŒå¤æ‚çš„ä»»åŠ¡æµç¨‹
- ğŸ” **åŒºåŸŸè¯†åˆ«**: æ”¯æŒå›¾åƒè¯†åˆ«å’Œå±å¹•åŒºåŸŸæ“ä½œ
- ğŸ“Š **æ—¥å¿—è®°å½•**: å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§
- ğŸ§© **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„æ¶æ„ï¼Œæ˜“äºæ‰©å±•å’Œå®šåˆ¶

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.13+
- Windows æ“ä½œç³»ç»Ÿ
- ç®¡ç†å‘˜æƒé™ï¼ˆæŸäº›çƒ­é”®åŠŸèƒ½éœ€è¦ï¼‰

### å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/quyansiyuanwang/EasyMacro.git
cd EasyMacro

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### åŸºæœ¬ä½¿ç”¨

1. **é…ç½®å®**ï¼šç¼–è¾‘ `macros/register.json` æ–‡ä»¶æ·»åŠ ä½ çš„å®å®šä¹‰

```json
{
  "$schema": "./schema/generated.schema.json",
  "macros": {
    "OpenSettings": {
      "description": "æ‰“å¼€ Windows è®¾ç½®",
      "macro_json": "macros/open_settings.json",
      "trigger": ["win+i"]
    }
  }
}
```

1. **åˆ›å»ºå·¥ä½œæµ**ï¼šåœ¨ `macros/` ç›®å½•ä¸‹åˆ›å»ºå¯¹åº”çš„å·¥ä½œæµæ–‡ä»¶

```json
{
  "$schema": "../src/ThirdParty/RecognizerFramework/workflow/schema/generated.schema.json",
  "begin": "OpenSettings",
  "jobs": {
    "OpenSettings": {
      "type": "Input",
      "input": {
        "type": "Keyboard",
        "keyboard": {
          "keys": ["win", "i"]
        }
      }
    }
  }
}
```

1. **è¿è¡Œç¨‹åº**ï¼š

```bash
python main.py macros/register.json
```

1. **ä½¿ç”¨å®**ï¼šæŒ‰ä¸‹é…ç½®çš„çƒ­é”®ï¼ˆå¦‚ `Win+I`ï¼‰è§¦å‘å®æ‰§è¡Œ

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### å‘½ä»¤è¡Œä½¿ç”¨

```bash
# åŸºæœ¬ç”¨æ³•
python main.py <å®æ³¨å†Œæ–‡ä»¶è·¯å¾„>

# ç¤ºä¾‹
python main.py macros/register.json
```

### é…ç½®æ–‡ä»¶ç»“æ„

EasyMacro ä½¿ç”¨ä¸¤ç§ä¸»è¦é…ç½®æ–‡ä»¶ï¼š

1. **å®æ³¨å†Œæ–‡ä»¶** (`macros/register.json`)ï¼šå®šä¹‰å®çš„å…ƒæ•°æ®å’Œè§¦å‘æ¡ä»¶
2. **å®å·¥ä½œæµæ–‡ä»¶** (`macros/*.json`)ï¼šå®šä¹‰å…·ä½“çš„æ‰§è¡Œæ­¥éª¤

### çƒ­é”®é…ç½®

æ”¯æŒå¤šç§çƒ­é”®æ ¼å¼ï¼š

```json
// å•ä¸ªæŒ‰é”®
"trigger": ["a"]

// ç»„åˆé”®
"trigger": ["ctrl+c"]
"trigger": ["alt+tab"] 
"trigger": ["ctrl+shift+n"]

// å¤šä¸ªè§¦å‘å™¨
"trigger": ["ctrl+shift+f", "f3"]

// ç‰¹æ®Šé”®
"trigger": ["grave"]     // åå¼•å·é”® `
"trigger": ["space"]     // ç©ºæ ¼é”®
"trigger": ["enter"]     // å›è½¦é”®
```

### ä»»åŠ¡ç±»å‹

æ”¯æŒä»¥ä¸‹ä»»åŠ¡ç±»å‹ï¼š

- **Input**: é”®ç›˜è¾“å…¥ã€é¼ æ ‡æ“ä½œã€æ–‡æœ¬è¾“å…¥
- **ROI**: å±å¹•åŒºåŸŸè¯†åˆ«å’Œæ“ä½œ
- **System**: ç³»ç»Ÿå‘½ä»¤ã€å»¶æ—¶ã€æ—¥å¿—ç­‰
- **Calculate**: æ•°å­¦è¡¨è¾¾å¼è®¡ç®—
- **OCR**: æ–‡å­—è¯†åˆ«ï¼ˆå¦‚æœå¯ç”¨ï¼‰

---

## ğŸ“ é¡¹ç›®ç»“æ„

```text
EasyMacro/
â”œâ”€â”€ main.py                 # ç¨‹åºå…¥å£
â”œâ”€â”€ README.MD              # é¡¹ç›®è¯´æ˜ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”œâ”€â”€ docs/                  # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ develop/
â”‚   â”‚   â””â”€â”€ Structure.MD   # é¡¹ç›®ç»“æ„æ–‡æ¡£
â”‚   â””â”€â”€ manual/
â”‚       â””â”€â”€ JsonField.MD   # JSON å­—æ®µè¯´æ˜
â”œâ”€â”€ macros/                # å®é…ç½®ç›®å½•
â”‚   â”œâ”€â”€ register.json      # å®æ³¨å†Œæ–‡ä»¶
â”‚   â”œâ”€â”€ macro.json         # ç¤ºä¾‹å®å·¥ä½œæµ
â”‚   â””â”€â”€ schema/           # JSON Schema æ–‡ä»¶
â”œâ”€â”€ src/                   # æºä»£ç 
â”‚   â”œâ”€â”€ CLI.py            # å‘½ä»¤è¡Œæ¥å£
â”‚   â”œâ”€â”€ Core/             # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ Models/           # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ ThirdParty/       # ç¬¬ä¸‰æ–¹åº“
â”‚   â””â”€â”€ Util/             # å·¥å…·å‡½æ•°
â””â”€â”€ tools/                 # å¼€å‘å·¥å…·
```

---

## ğŸ’¡ ç¤ºä¾‹å®

### 1. å¿«é€Ÿæˆªå›¾

```json
// macros/register.json
{
  "macros": {
    "Screenshot": {
      "description": "å¿«é€Ÿæˆªå›¾",
      "macro_json": "macros/screenshot.json",
      "trigger": ["grave"]
    }
  }
}
```

```json
// macros/screenshot.json
{
  "$schema": "../src/ThirdParty/RecognizerFramework/workflow/schema/generated.schema.json",
  "begin": "TakeScreenshot",
  "jobs": {
    "TakeScreenshot": {
      "type": "Input",
      "input": {
        "type": "Keyboard",
        "keyboard": {
          "keys": ["win", "shift", "s"]
        }
      }
    }
  }
}
```

### 2. å¿«é€Ÿæœç´¢

```json
// æŒ‰ Ctrl+Shift+F æ‰“å¼€æµè§ˆå™¨å¹¶æœç´¢
{
  "macros": {
    "QuickSearch": {
      "description": "å¿«é€Ÿæœç´¢",
      "macro_json": "macros/quick_search.json",
      "trigger": ["ctrl+shift+f"]
    }
  }
}
```

### 3. æ–‡æœ¬æ¨¡æ¿

```json
// å¿«é€Ÿè¾“å…¥å¸¸ç”¨æ–‡æœ¬
{
  "jobs": {
    "InsertEmail": {
      "type": "Input",
      "input": {
        "type": "Text",
        "text": {
          "text": "your.email@example.com"
        }
      }
    }
  }
}
```

---

## ğŸ”§ é«˜çº§åŠŸèƒ½

### å·¥ä½œæµæ§åˆ¶

æ”¯æŒå¤æ‚çš„å·¥ä½œæµæ§åˆ¶ï¼š

- **æ¡ä»¶åˆ†æ”¯**: æ ¹æ®æ‰§è¡Œç»“æœè·³è½¬åˆ°ä¸åŒä»»åŠ¡
- **å¾ªç¯æ§åˆ¶**: è®¾ç½®æ‰§è¡Œæ¬¡æ•°é™åˆ¶
- **é”™è¯¯å¤„ç†**: è‡ªå®šä¹‰é”™è¯¯å¤„ç†é€»è¾‘
- **å»¶æ—¶æ§åˆ¶**: ä»»åŠ¡å‰åæ·»åŠ å»¶æ—¶

### å˜é‡å’Œè®¡ç®—

æ”¯æŒè¡¨è¾¾å¼è®¡ç®—å’Œå˜é‡ä¼ é€’ï¼š

```json
{
  "type": "Calculate",
  "calculate": {
    "expressions": {
      "result": "x * 2 + y"
    },
    "variables": {
      "x": 10,
      "y": 5
    }
  }
}
```

### åŒºåŸŸè¯†åˆ«

æ”¯æŒåŸºäºå›¾åƒçš„å±å¹•åŒºåŸŸè¯†åˆ«ï¼š

```json
{
  "type": "ROI",
  "roi": {
    "type": "MoveMouse",
    "image": {
      "path": "images/button.png",
      "confidence": 0.8
    }
  }
}
```

---

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°å®

1. åœ¨ `macros/register.json` ä¸­æ·»åŠ å®å®šä¹‰
2. åˆ›å»ºå¯¹åº”çš„å·¥ä½œæµæ–‡ä»¶
3. é‡å¯ç¨‹åºåŠ è½½æ–°é…ç½®

### æ‰©å±•åŠŸèƒ½

EasyMacro å…·æœ‰è‰¯å¥½çš„æ‰©å±•æ€§ï¼š

- **è‡ªå®šä¹‰ä»»åŠ¡ç±»å‹**: åœ¨ RecognizerFramework ä¸­æ·»åŠ æ–°çš„æ‰§è¡Œå™¨
- **è‡ªå®šä¹‰çƒ­é”®å¤„ç†**: ä¿®æ”¹ `KeyboardMonitor` ç±»
- **è‡ªå®šä¹‰æ•°æ®æ¨¡å‹**: æ‰©å±• `Macro` å’Œ `MacroSet` ç±»

### è°ƒè¯•æŠ€å·§

1. å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼šåœ¨å·¥ä½œæµæ–‡ä»¶ä¸­è®¾ç½® `"debug": true`
2. æŸ¥çœ‹æ—¥å¿—ï¼šæ£€æŸ¥ `log/` ç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶
3. æµ‹è¯•çƒ­é”®ï¼šä½¿ç”¨ç®€å•çš„æµ‹è¯•å®éªŒè¯çƒ­é”®é…ç½®

---

## ğŸ“‹ å¸¸è§é—®é¢˜

### Q: çƒ­é”®ä¸ç”Ÿæ•ˆæ€ä¹ˆåŠï¼Ÿ

A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

- ç¡®ä¿çƒ­é”®æ ¼å¼æ­£ç¡®
- æ£€æŸ¥æ˜¯å¦ä¸å…¶ä»–ç¨‹åºå†²çª
- ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œç¨‹åº
- ç¡®è®¤å®é…ç½®æ–‡ä»¶è·¯å¾„æ­£ç¡®

### Q: å¦‚ä½•é€€å‡ºç¨‹åºï¼Ÿ

A: é»˜è®¤ä½¿ç”¨ `Ctrl+C` é€€å‡ºç¨‹åºï¼Œæˆ–åœ¨ç»ˆç«¯ä¸­æŒ‰ `Ctrl+C`ã€‚

### Q: æ”¯æŒå“ªäº›æ–‡ä»¶æ ¼å¼ï¼Ÿ

A: ç›®å‰æ”¯æŒ JSON æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œæœªæ¥å¯èƒ½æ”¯æŒ YAML ç­‰æ ¼å¼ã€‚

### Q: å¦‚ä½•å¤‡ä»½é…ç½®ï¼Ÿ

A: ç›´æ¥å¤‡ä»½ `macros/` ç›®å½•å³å¯ï¼ŒåŒ…å«æ‰€æœ‰å®é…ç½®æ–‡ä»¶ã€‚

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ Python PEP 8 ä»£ç é£æ ¼
- æ·»åŠ é€‚å½“çš„ç±»å‹æç¤º
- ç¼–å†™æ¸…æ™°çš„æ–‡æ¡£å­—ç¬¦ä¸²
- æ·»åŠ å¿…è¦çš„å•å…ƒæµ‹è¯•

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦ç»†ä¿¡æ¯è¯·æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

## ğŸ™ è‡´è°¢

- [RecognizerFramework](https://github.com/quyansiyuanwang/RecognizerFramework) - å¼ºå¤§çš„å·¥ä½œæµå¼•æ“
- [keyboard](https://github.com/boppreh/keyboard) - Python é”®ç›˜äº‹ä»¶å¤„ç†
- [pydantic](https://github.com/pydantic/pydantic) - æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–

---

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µ: [https://github.com/quyansiyuanwang/EasyMacro](https://github.com/quyansiyuanwang/EasyMacro)
- Issues: [https://github.com/quyansiyuanwang/EasyMacro/issues](https://github.com/quyansiyuanwang/EasyMacro/issues)

---

äº«å—è‡ªåŠ¨åŒ–çš„ä¹è¶£ï¼ğŸ‰
